
@model IEnumerable<Legalizaciones.Model.EmpleadoPermiso>
@{
    ViewData["Title"] = "Preferencias de Legalizacion";
}
<div class="row">
    <div class="col-sm-12">
        <div class="box">
            <div class="box-body">
                <small>
                    <a href='@Url.Action("Index","Home")'> Inicio </a>
                     <strong>Preferencias de Legalizacion</strong>
                </small>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-xs-12">
        <div class="box">
            <div class="box-header with-border">
                <span class="fa fa-gear"></span>
                <h1 class="box-title">Preferencias de Legalizacion</h1>
                <button class="btn btn-primary" style="float:right;" data-toggle="modal" id="triggerModal" data-target="#addEmpleadoPreferenciaLegalizacion">Añadir permisos a usuario</button>
            </div>
            <div class="box-body">
                <table id="tblEmpleadoPermisos" class="table table-bordered table-hover">
                    <thead>
                        <tr>
                            <th> Empleado</th>
                            <th> Permiso</th>
                            <th> Eliminar</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.Count() > 0)
                        {
                            @foreach (var item in Model)

                            {
                                <tr>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.EmpleadoPermisoNombre)
                                    </td>
                                    <td>
                                        Legalizaciones y Gastos
                                        @*Html.DisplayFor(modelItem => item.TipoPermiso)*@
                                    </td>
                                    <td>
                                        <a class="item-btn" onclick="deleteEmpleadoPreferencia(@item.Id);">
                                            <span class="fa fa-trash"></span>
                                        </a>
                                    </td>
                                </tr>
                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="8">
                                    No se encontraron resultados...
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div id="addEmpleadoPreferenciaLegalizacion" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title text-center">Añadir permisos de legalización a empleado</h4>
                </div>
                <div class="modal-body">
                    <div class="col-md-12">
                        <div class="col-md-12 pb-2">
                            <label class="control-label">Empleado</label>
                            @Html.DropDownList("Empleado", new SelectList(string.Empty, "Value", "Text"), "Seleccione...", new { @class = "form-control", id = "Empleado", @required = "required" })
                        </div>
                    </div>
                </div>
                <div class="modal-footer text-center">
                    <button type="button" class="btn btn-primary" id="addEmpleadoPermiso" disabled><span class="fa fa-user-plus"></span> Añadir</button>
                </div>
            </div>
        </div>
    </div>
</div>


@section scripts {
    <script src="~/js/PermisoSolicitudScript.js"></script>
    <script src="~/js/select2.min.js"></script>
    <link href="~/css/select2.min.css" rel="stylesheet" />
    <script src="~/lib/legalizaciones/lib/datatables.net/js/jquery.dataTables.js"></script>
}
<style>
    .text-center {
        text-align: center !important;
    }

    .pb-2 {
        padding-bottom: 12px;
    }
</style>

<script>
        function deleteEmpleadoPreferencia(id) {
        $.ajax({
            type: "DELETE",
            url: "/Empleado/PreferenciasLegalizacionEliminar?id=" + id,
            datatype: "Json",
            beforeSend: function () {
                console.log("Before Send Request");
            },
            success: function (data) {
                console.log("Succes!")
            },
            complete: function () {
                console.log("Complete AJAX")
                location.reload();
                $("#addEmpleadoPreferenciaLegalizacion").modal("hide");
            }
        });
    }
</script>